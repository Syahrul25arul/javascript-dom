<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Bootstrap demo</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous" />
	</head>
	<body>
		<div class="container mt-2">
			<!-- Card -->
			<div class="card">
				<div class="card-body">
					<form>
						<div class="row justify-content-center">
							<div class="col-6 align-self-center">
								<div class="mb-3">
									<label for="exampleFormControlInput1" class="form-label">Nama</label>
									<input type="text" class="form-control" id="input-name" placeholder="isi nama" required />
									<div id="invalid-feedback-name" class="invalid-feedback">Nama Tidak Boleh Kosong</div>
								</div>
								<div class="mb-3">
									<label for="exampleFormControlInput1" class="form-label">Alamat</label>
									<input type="text" class="form-control" id="input-alamat" placeholder="isi alamat" />
									<div id="invalid-feedback-alamat" class="invalid-feedback">Alamat Tidak boleh kosong</div>
								</div>
								<div class="mb-3">
									<label for="exampleFormControlInput1" class="form-label">No Tlp</label>
									<input type="text" class="form-control" id="input-tlp" placeholder="maximal panjang nomor 12" onkeyup="validasiNoTlp(this)" />
									<div id="invalid-feedback-tlp" class="invalid-feedback"></div>
								</div>
								<div class="mb-3">
									<label for="exampleFormControlInput1" class="form-label">Email</label>
									<input type="text" class="form-control" id="input-email" placeholder="isi email anda" />
									<div id="invalid-feedback-email" class="invalid-feedback"></div>
								</div>
								<div class="mb-2 form-check">
									<input class="form-check-input" type="checkbox" id="input-checkbox" value="backend" />
									<label class="form-check-label" for="checkbox-backend"> Backend Enginer </label>
								</div>
								<div class="mb-2 form-check">
									<input class="form-check-input" type="checkbox" id="input-checkbox" value="frontend" />
									<label class="form-check-label" for="checkbox-frontend"> Frontend Enginer </label>
									<div id="invalid-feedback-checkbox" class="invalid-feedback"></div>
								</div>
								<div class="col-2">
									<button class="btn btn-primary" type="button" onclick="formSubmit(this)">Submit</button>
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
			<!-- end card -->

			<!-- table -->
			<table class="table table-dark table-striped table-hover mt-5">
				<thead>
					<tr>
						<th>Nama</th>
						<th>Alamat</th>
						<th>No Tlp</th>
						<th>Email</th>
						<th>Posisi</th>
					</tr>
				</thead>
				<tbody id="table-data"></tbody>
			</table>
			<!-- end table -->
		</div>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
		<script>
			function formSubmit(e) {
				// tangkap semua tag input
				let inputTag = document.getElementsByTagName("input");

				// tangkap semua tag yang mempunyai kelas invalid
				let isInvalid = document.querySelectorAll(".is-invalid");

				isInvalid.forEach((e) => {
					// saat di submit, hapus terlebih dahulu kelas is-invalid agar memulai validasi dari awal
					e.classList.remove("is-invalid");
				});

				// tangkap tbody dari table untuk nanti dimasukkan data
				let tableData = document.getElementById("table-data");

				// buat element tr untuk nanti di masukkan ke dalam tr
				let tr = document.createElement("tr");

				for (let i = 0; i < inputTag.length; i++) {
					// jika yang di loop sekarang input checkbox, looping akan dilanjutkan ke iterasi berikutnya
					// karna validasi checkbox dilakukan terpisah dari looping ini
					if (inputTag[i].id == "input-checkbox") continue;

					// buat element td untuk nanti dimasukkan ke dalam element tr yang tadi dibuat
					let td = document.createElement("td");

					// buat textnode yang akan dimasukkan ke element td barusan
					// dengan value dari input yang saat ini di iterasi
					let nodeValue = document.createTextNode(inputTag[i].value);

					// jika value dari input saat yang di iterasi saat ini kosong, maka berikan kelasi is-invalid
					// kelas is-invalid diberikan agar memberikan alert dan tanda merah sebagai tanda bahwa form yang di submit tidak valid
					if (inputTag[i].value == "") inputTag[i].classList.add("is-invalid");

					if (inputTag[i].id == "input-tlp") {
						// jika value input tlp kosong maka berikan alert
						if (inputTag[i].value == "") feedBackMessage(inputTag[i].id, "field nomort tlp tidak boleh kosong");

						// let patternOld = /\+62+\d{10,11}/

						// jika value darin input tlp tidak sesuai dengan pattern yang di tentukan, berikan alert
						if (!inputTag[i].value.match(/\+62+\d{10,11}$/)) {
							inputTag[i].classList.add("is-invalid");

							feedBackMessage(inputTag[i].id, "nomor telepon anda tidak valid periksa kembali nomor telepon anda. pastikan menggunakna +62 didepan nomor telepon");
						}
					}

					if (inputTag[i].id == "input-email") {
						// jika input email mempunyai kelasi is-invalid, maka berikan alert
						// kelas is-invalid pada email ini terjadi karna value kosong, di berikan pada kode baris 106
						if (inputTag[i].classList.contains("is-invalid")) feedBackMessage(inputTag[i].id, "field email masih kosong");
						else {
							let pattern = /^([\. \_ a-zA-Z0-9]+)@(\w+)\.([a-zA-Z]){2,5}/g;

							// jika value dari input email tidak sesuai dengan pattern yang di tentukan, berikan alert
							if (!pattern.test(inputTag[i].value)) {
								inputTag[i].classList.add("is-invalid");

								feedBackMessage(inputTag[i].id, "email anda tidak valid");
							}
						}
					}

					// memasukkan element td yang mempunyai value dari input yang telah di iterasi dan dimasukkan kedalam element tr
					td.appendChild(nodeValue);
					tr.appendChild(td);

					// kosongkan kembali value dari setiap input
					inputTag[i].value = "";
				}

				// ambil semua input yang mempunyai id input-checkbox
				let checkbox = document.querySelectorAll("#input-checkbox");

				let checkValue = [];
				checkbox.forEach((e) => {
					// jika setiap input yang di iterasi di centang, masukkan value kedalam array checkValue
					if (e.checked) checkValue.push(e.value);
				});

				// jika panjang dari array checkValue 0, berikan alert
				if (checkValue.length < 1) {
					feedBackMessage("input-checkbox", "pilih setidak nya salah satu dari checkbox");
					checkbox.forEach((e) => e.classList.add("is-invalid"));
				} else {
					// jika panjang dari array checkValue lebih dari 0, maka buat element td dan tr, dan masukkan value dari array checkValue
					let td = document.createElement("td");
					checkValue.length > 1 ? (td.innerHTML = checkValue.join()) : (td.innerHTML = checkValue[0]);
					tr.appendChild(td);
				}

				// hapus kembali centang dari checkbox setelah di lakukan validasi
				checkbox.forEach((e) => {
					e.checked = false;
				});

				// jika masih ada input yang belum valid, maka jangan masukkan data kedalam table
				if (document.querySelectorAll(".is-invalid").length > 0) return;

				// jika semua input valid, maka masukkan data kedalam table
				tableData.appendChild(tr);
			}

			function validasiNoTlp(e) {
				e.classList.remove("is-invalid");

				if (e.value.match(/([a-z A-Z~`!@#$%^&*()_=|\\\]\[\{\}'":;?/\.>,<-])/g)) {
					e.classList.add("is-invalid");
					feedBackMessage(e.id, "isi dengan angka");
					let valueBaru = e.value.replace(/[^\d\+]/gi, "").toString();
					return (e.value = valueBaru);
				}
			}

			function feedBackMessage(id, message) {
				let getId = id.split("-");
				document.getElementById(`invalid-feedback-${getId[1]}`).innerHTML = message;
			}
		</script>
	</body>
</html>
